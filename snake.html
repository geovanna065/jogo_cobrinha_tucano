<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Cobrinha com Comida Tucano</title>
  <style>
    body {
      background: #0f1720;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      color: white;
    }
    canvas {
      background: #071422;
      border: 3px solid #ffffff30;
      border-radius: 10px;
    }
  </style>
</head>
<body>

<canvas id="canvas" width="600" height="600"></canvas>

<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  const COLS = 30;
  const ROWS = 30;
  const block = canvas.width / COLS;

  let snake, dir, nextDir, food, score, level, speed;
  let paused = true;
  let gameOver = false;

  // -------------------------------------
  // DESENHO DA COMIDA (MINI TUCANO)
  // -------------------------------------
  function drawMiniTucano(x, y, size) {

    // corpo preto
    ctx.fillStyle = "black";
    ctx.fillRect(x, y, size, size * 0.6);

    // barriga branca
    ctx.fillStyle = "white";
    ctx.fillRect(x + size * 0.2, y + size * 0.3, size * 0.4, size * 0.3);

    // olho
    ctx.fillStyle = "cyan";
    ctx.fillRect(x + size * 0.05, y + size * 0.1, size * 0.18, size * 0.18);

    // bico amarelo
    ctx.fillStyle = "yellow";
    ctx.fillRect(x + size * 0.6, y + size * 0.2, size * 0.7, size * 0.2);

    // ponta laranja do bico
    ctx.fillStyle = "orange";
    ctx.fillRect(x + size * 0.6, y + size * 0.4, size * 0.7, size * 0.2);
  }

  // -------------------------------------
  // INÍCIO DO JOGO
  // -------------------------------------
  function reset() {
    snake = [
      { x: 15, y: 15 },
      { x: 14, y: 15 },
      { x: 13, y: 15 }
    ];

    dir = { x: 1, y: 0 };
    nextDir = { ...dir };

    score = 0;
    level = 1;
    speed = 6;
    paused = true;
    gameOver = false;

    placeFood();
    draw();
  }

  function placeFood() {
    while (true) {
      const x = Math.floor(Math.random() * COLS);
      const y = Math.floor(Math.random() * ROWS);

      if (!snake.some(s => s.x === x && s.y === y)) {
        food = { x, y };
        return;
      }
    }
  }

  // CONTROLES
  window.addEventListener("keydown", (e) => {
    const key = e.key.toLowerCase();

    if (key === " ") {
      if (gameOver) reset();
      paused = false;
      return;
    }

    if (key === "arrowup" || key === "w") tryChangeDir(0, -1);
    if (key === "arrowdown" || key === "s") tryChangeDir(0, 1);
    if (key === "arrowleft" || key === "a") tryChangeDir(-1, 0);
    if (key === "arrowright" || key === "d") tryChangeDir(1, 0);
  });

  function tryChangeDir(x, y) {
    if (dir.x === -x && dir.y === -y) return;
    nextDir = { x, y };
  }

  // -------------------------------------
  // ATUALIZAÇÃO DO JOGO
  // -------------------------------------
  function step() {
    if (paused || gameOver) return;

    dir = nextDir;

    const head = {
      x: snake[0].x + dir.x,
      y: snake[0].y + dir.y
    };

    // BATEU NA PAREDE
    if (head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS) {
      gameOver = true;
      return;
    }

    // BATEU EM SI MESMO
    if (snake.some(s => s.x === head.x && s.y === head.y)) {
      gameOver = true;
      return;
    }

    snake.unshift(head);

    // COME O TUCANO (comida)
    if (head.x === food.x && head.y === food.y) {
      score += 10;
      
      const newLevel = Math.floor(score / 30) + 1;
      if (newLevel > level) {
        level = newLevel;
        speed += 0.4;
      }

      placeFood();
    } else {
      snake.pop();
    }
  }

  // -------------------------------------
  // DESENHAR O JOGO
  // -------------------------------------
  function draw() {
    ctx.fillStyle = "#071422";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // comida tucano
    drawMiniTucano(food.x * block, food.y * block, block);

    // cobrinha
    snake.forEach((s, i) => {
      ctx.fillStyle = i === 0 ? "#c8ffdb" : "#6aff7a";
      ctx.fillRect(s.x * block, s.y * block, block, block);
    });

    // textos
    ctx.fillStyle = "white";
    ctx.font = "18px Arial";
    ctx.fillText("Pontuação: " + score, 10, 20);
    ctx.fillText("Nível: " + level, 10, 40);

    if (paused && !gameOver) {
      ctx.font = "26px Arial";
      ctx.fillText("Pressione ESPAÇO para começar", 100, 300);
    }

    if (gameOver) {
      ctx.fillStyle = "red";
      ctx.font = "40px Arial";
      ctx.fillText("GAME OVER!", 170, 300);
      ctx.font = "24px Arial";
      ctx.fillText("Pressione ESPAÇO para reiniciar", 135, 340);
    }
  }

  let lastTime = 0;
  function loop(t) {
    if (!lastTime) lastTime = t;

    if (t - lastTime > 1000 / speed) {
      step();
      draw();
      lastTime = t;
    }

    requestAnimationFrame(loop);
  }

  reset();
  requestAnimationFrame(loop);
</script>

</body>
</html>